<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-database/sql/transaction" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Transaction | DuyCode</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://your-docusaurus-site.example.com/blog/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://your-docusaurus-site.example.com/blog/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://your-docusaurus-site.example.com/blog/content/database/sql/transaction"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Transaction | DuyCode"><meta data-rh="true" name="description" content="A.Các chế  độ lock"><meta data-rh="true" property="og:description" content="A.Các chế  độ lock"><link data-rh="true" rel="icon" href="/blog/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-site.example.com/blog/content/database/sql/transaction"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/blog/content/database/sql/transaction" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/blog/content/database/sql/transaction" hreflang="x-default"><link rel="stylesheet" href="/blog/assets/css/styles.069b8a9f.css">
<script src="/blog/assets/js/runtime~main.d3b5771b.js" defer="defer"></script>
<script src="/blog/assets/js/main.14606ee1.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/blog/"><div class="navbar__logo"><img src="/blog/img/logo.svg" alt="DuyCode Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/blog/img/logo.svg" alt="DuyCode Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">DuyCode</b></a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/blog/content/category/language/">Language</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/blog/content/category/design-pattern">Design Pattern</a></li><li><a class="dropdown__link" href="/blog/content/category/javascript">Javascript</a></li><li><a class="dropdown__link" href="/blog/content/category/html-css">HTML-CSS</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/blog/content/category/database/">Database</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/blog/content/category/mongodb">MongoDB</a></li><li><a class="dropdown__link" href="/blog/content/category/sql">SQL</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/blog/content/category/framework/">Framework</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/blog/content/category/vuejs">VueJS</a></li><li><a class="dropdown__link" href="/blog/content/category/google-project">Google Project</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/blog/content/category/operating-system/">Operating Systems</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/blog/content/category/windows">Windows</a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/blog/content/database/sql/backup-restore">MySQL and MariaDB Backup and Restore</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/blog/content/database/sql/sql-injection">SQL Injection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/blog/content/database/sql/sql-server">SQL SERVER</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/blog/content/database/sql/transaction">Transaction</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/blog/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Transaction</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Transaction</h1></header>
<h3>A.Các chế  độ lock </h3>
<blockquote>UPDATE user SET username = &#x27;Bob&#x27; WHERE id = &#x27;1&#x27;;	</blockquote>
<ul>
<li>Exclusive lock (lock độc quyền): Row user có id = 1 sẽ bị exclusive lock ==&gt; Các transaction khác phải chờ câu lệnh trên thực hiện xong</li>
<li>Share lock (lock chia sẻ): Bảng user sẽ bị share lock nên các transaction khác sẽ không thể cập nhật cấu trúc của nó (vì để thay đổi cấu trúc bảng thì cần phải tiến hành exclusive lock bảng). Tuy nhiên các transaction khác vẫn có thể thay đổi các dòng khác của bảng employees (khi đó bảng employees sẽ bị nhiều share lock).</li>
</ul>
<h3>B.Các loại lock </h3>
<ol>
<li>DDL lock (lock cấu trúc): có chức năng bảo vệ cấu trúc của các đối tượng trong schema, ví dụ như bảng, view,</li>
<li>DML lock (lock dữ liệu):</li>
</ol>
<ul>
<li>Thường thì SELECT không phải đợi UPDATE</li>
<li>UPDATE phải đợi nhau nếu cùng ghi trên 1 dòng</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="a-các-loại-anomaly">A. Các loại Anomaly<a href="#a-các-loại-anomaly" class="hash-link" aria-label="Direct link to A. Các loại Anomaly" title="Direct link to A. Các loại Anomaly">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-dirty-reads">1. Dirty Reads<a href="#1-dirty-reads" class="hash-link" aria-label="Direct link to 1. Dirty Reads" title="Direct link to 1. Dirty Reads">​</a></h3>
<p>Transaction 2 đọc dữ liệu chưa đươc commit ở transaction 1</p>
<table><thead><tr><th>1</th><th>2</th><th>DATA</th></tr></thead><tbody><tr><td>START TRANSACTION;</td><td></td><td>id = 1, username = &#x27;Alice&#x27;</td></tr><tr><td>UPDATE user SET username = &#x27;Bob&#x27; WHERE id = &#x27;1&#x27;;</td><td>START TRANSACTION;</td><td>id = 1, username = &#x27;Bob&#x27;</td></tr><tr><td></td><td>SELECT username FROM user where id = &#x27;1&#x27;;</td><td>id = 1, username = &#x27;Bob&#x27;</td></tr><tr><td></td><td>COMMIT;</td><td></td></tr><tr><td>ROLLBACK;</td><td></td><td>id = 1, username = &#x27;Alice&#x27;</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-nonrepeatable-reads">2. Nonrepeatable Reads<a href="#2-nonrepeatable-reads" class="hash-link" aria-label="Direct link to 2. Nonrepeatable Reads" title="Direct link to 2. Nonrepeatable Reads">​</a></h3>
<ul>
<li>Transaction 2 đọc dữ liệu 2 lần ra 2 kết quả khác nhau</li>
</ul>
<table><thead><tr><th>1</th><th>2</th><th>DATA</th></tr></thead><tbody><tr><td></td><td>START TRANSACTION;</td><td>id = 1, username = &#x27;Alice&#x27;</td></tr><tr><td>START TRANSACTION;</td><td>SELECT username FROM user where id = &#x27;1&#x27;;</td><td>id = 1, username = &#x27;Alice&#x27;</td></tr><tr><td>UPDATE user SET username = &#x27;Bob&#x27; WHERE id = &#x27;1&#x27;;</td><td></td><td>id = 1, username = &#x27;Bob&#x27;</td></tr><tr><td>COMMIT;</td><td>SELECT username FROM user where id = &#x27;1&#x27;;</td><td>id = 1, username = &#x27;Bob&#x27;</td></tr><tr><td></td><td>COMMIT;</td><td></td></tr></tbody></table>
<h3>3. Phantom Record: Bản ghi ma </h3>
<ul>
<li>Bản ghi &#x27;Bob&#x27; đã được thêm và làm cho kết quả đọc 2 lần sai lệch</li>
</ul>
<table><thead><tr><th>1</th><th>2</th><th>DATA</th></tr></thead><tbody><tr><td>START TRANSACTION;</td><td>START TRANSACTION;</td><td></td></tr><tr><td></td><td>SELECT username FROM user where group_id = &#x27;1&#x27;;</td><td>&#x27;Alice&#x27;</td></tr><tr><td>INSERT INTO user (id, group_id, username) VALUES (4,1,&#x27;Bob&#x27;);</td><td></td><td></td></tr><tr><td></td><td>SELECT username FROM user where group_id = &#x27;1&#x27;;</td><td>&#x27;Alice&#x27;,&#x27;Bob&#x27;</td></tr><tr><td>COMMIT;</td><td>COMMIT;</td><td></td></tr></tbody></table>
<h2>B. Isolation level</h2>
<table><thead><tr><th></th><th>Read Uncommitted</th><th>Read Committed</th><th>Repeatable Read</th><th>Serializable</th></tr></thead><tbody><tr><td>UPDATE đợi transaction khác COMMIT UPDATE</td><td>Y</td><td>Y</td><td>Y</td><td>Y</td></tr><tr><td>SELECT đợi transaction khác COMMIT UPDATE</td><td>N</td><td>Y</td><td>Y</td><td>Y</td></tr><tr><td>LOCK khi SELECT (không cho transaction khác update)</td><td>N</td><td>N</td><td>Y</td><td>Y</td></tr><tr><td>LOCK khi SELECT (không cho transaction khác delete, insert)</td><td>N</td><td>N</td><td>N</td><td>Y</td></tr><tr><td></td><td></td><td></td><td></td><td></td></tr><tr><td>Dirt Read</td><td>Y</td><td>N</td><td>N</td><td>N</td></tr><tr><td>Nonerepeatable Read</td><td>Y</td><td>Y</td><td>N</td><td>N</td></tr><tr><td>Fantom Read</td><td>Y</td><td>Y</td><td>Y</td><td>N</td></tr></tbody></table></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/content/database/sql/transaction.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/content/database/sql/sql-server"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">SQL SERVER</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#a-các-loại-anomaly" class="table-of-contents__link toc-highlight">A. Các loại Anomaly</a><ul><li><a href="#1-dirty-reads" class="table-of-contents__link toc-highlight">1. Dirty Reads</a></li><li><a href="#2-nonrepeatable-reads" class="table-of-contents__link toc-highlight">2. Nonrepeatable Reads</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>