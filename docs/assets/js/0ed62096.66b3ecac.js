"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[3095],{2505:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>d,contentTitle:()=>t,default:()=>a,frontMatter:()=>c,metadata:()=>r,toc:()=>o});var i=s(4848),h=s(8453);const c={},t="SSH",r={id:"operating-system/ssh",title:"SSH",description:"I. T\u1ea1o c\u1eb7p SSH key",source:"@site/content/operating-system/ssh.md",sourceDirName:"operating-system",slug:"/operating-system/ssh",permalink:"/blog/content/operating-system/ssh",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/content/operating-system/ssh.md",tags:[],version:"current",frontMatter:{},sidebar:"defaultSidebar",previous:{title:"Nginx v\xe0 SSL",permalink:"/blog/content/operating-system/nginx"},next:{title:"Ubuntu c\u01a1 b\u1ea3n",permalink:"/blog/content/operating-system/ubuntu"}},d={},o=[{value:"I. T\u1ea1o c\u1eb7p SSH key",id:"i-t\u1ea1o-c\u1eb7p-ssh-key",level:2},{value:"1. T\u1ea1o c\u1eb7p SSH key m\u1edbi",id:"1-t\u1ea1o-c\u1eb7p-ssh-key-m\u1edbi",level:3},{value:"2. Th\xeam key v\xe0o ssh-agent",id:"2-th\xeam-key-v\xe0o-ssh-agent",level:3},{value:"3. K\u1ebft n\u1ed1i",id:"3-k\u1ebft-n\u1ed1i",level:3},{value:"4. X\xf3a key c\u0169 \u0111\xe3 k\u1ebft n\u1ed1i do server c\u1eadp nh\u1eadt ho\u1eb7c thay \u0111\u1ed5i",id:"4-x\xf3a-key-c\u0169-\u0111\xe3-k\u1ebft-n\u1ed1i-do-server-c\u1eadp-nh\u1eadt-ho\u1eb7c-thay-\u0111\u1ed5i",level:3},{value:"5. M\u1ed9t v\xe0i l\u01b0u \xfd",id:"5-m\u1ed9t-v\xe0i-l\u01b0u-\xfd",level:3},{value:"II. Config Server",id:"ii-config-server",level:2},{value:"1. Th\xeam public-key",id:"1-th\xeam-public-key",level:3},{value:"1.1. Th\xeam public key",id:"11-th\xeam-public-key",level:4},{value:"1.2. C\u1ea5u h\xecnh sshd",id:"12-c\u1ea5u-h\xecnh-sshd",level:4},{value:"III. Connect \u0111\u01a1n gi\u1ea3n",id:"iii-connect-\u0111\u01a1n-gi\u1ea3n",level:2}];function l(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,h.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"ssh",children:"SSH"})}),"\n",(0,i.jsx)(e.h2,{id:"i-t\u1ea1o-c\u1eb7p-ssh-key",children:"I. T\u1ea1o c\u1eb7p SSH key"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"Gi\u1ea3 s\u1eed ta s\u1ebd t\u1ea1o 1 c\u1eb7p key l\xe0: version_schat v\xe0 version_schat.pub\n- Ph\xeda Client s\u1ebd d\xf9ng private key: version_schat\n- Ph\xeda Server s\u1ebd d\xf9ng publickey: version_schat.pub\n"})}),"\n",(0,i.jsx)(e.h3,{id:"1-t\u1ea1o-c\u1eb7p-ssh-key-m\u1edbi",children:"1. T\u1ea1o c\u1eb7p SSH key m\u1edbi"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'// Tr\xean windown kh\xf4ng d\xf9ng CMD, h\xe3y d\xf9ng Gitbash nh\xe9\n// Xem danh s\xe1ch key hi\u1ec7n c\xf3.\n$ ls -al ~/.ssh\n# id_rsa      --\x3e private key\n# id_rsa.pub  --\x3e public key\n\n// T\u1ea1o c\u1eb7p key m\u1edbi v\u1edbi m\xe3 h\xf3a rsa\n$ ssh-keygen -t rsa -b 4096 -C "email_cua_ban@example.com"\n// ng\u1eafn g\u1ecdn h\u01a1n\n$ ssh-keygen -t rsa\n\n// L\u01b0u \xfd: rsa d\u1ea7n kh\xf4ng \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng n\u1eefa -> chuy\u1ec3n sang d\xf9ng ecdsa\nssh-keygen -t ecdsa -b 521 -C "your_email@example.com"\n\n// \u0110i\u1ec1n n\u01a1i l\u01b0u key: /home/duy.ngo/.ssh/id_ecdsa\n# Enter file in which to save the key (/home/duy.ngo/.ssh/id_ecdsa): [Press enter]\n\n// \u0110i\u1ec1n m\u1eadt kh\u1ea9u cho key\n# Enter passphrase (empty for no passphrase): [Type a passphrase]\n# Enter same passphrase again: [Type passphrase again]\n\n# Your identification has been saved in /home/duy.ngo/.ssh/id_ecdsa\n# Your public key has been saved in /home/duy.ngo/.ssh/id_ecdsa.pub\n# The key fingerprint is:\n# SHA256:uOQVsO0QRG5jC/Lw0UReEfxAxiSIYf4Y4IkxO0ppBWc your_email@example.com\n\n// Xem l\u1ea1i danh s\xe1ch key\n$ ls -al ~/.ssh\n# id_rsa\n# id_rsa.pub\n# id_ecdsa       --\x3e private key v\u1eeba t\u1ea1o\n# id_ecdsa.pub   --\x3e public key v\u1eeba t\u1ea1o\n'})}),"\n",(0,i.jsx)(e.h3,{id:"2-th\xeam-key-v\xe0o-ssh-agent",children:"2. Th\xeam key v\xe0o ssh-agent"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'// Ki\u1ec3m tra ssh-agent xem \u0111\xe3 \u0111\u01b0\u1ee3c k\xedch ho\u1ea1t ch\u01b0a. N\u1ebfu tr\xean window ko nh\u1eadn l\u1ec7nh eval th\xec ch\u1ea1y b\u1eb1ng Gitbash\n$ eval "$(ssh-agent -s)"\n# Agent pid 59566\n// N\u1ebfu ch\u01b0a k\xedch ho\u1ea1t ssh-agent. Tr\xean window, d\xf9ng PowerShell v\u1edbi Administrator\nGet-Service -Name ssh-agent | Set-Service -StartupType Manual\n\n// Th\xeam key "version_schat" v\xe0o ssh\n$ ssh-add ~/.ssh/id_ecdsa\n// \u0110i\u1ec1n password c\u1ee7a key id_ecdsa\n# Enter passphrase for /home/duy.ngo/.ssh/id_ecdsa:\n\n# Identity added: /home/duy.ngo/.ssh/id_ecdsa(your_email@example.com)\n'})}),"\n",(0,i.jsx)(e.h3,{id:"3-k\u1ebft-n\u1ed1i",children:"3. K\u1ebft n\u1ed1i"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"// L\u1ea5y n\u1ed9i dung public key\n$ cat ~/.ssh/id_ecdsa.pub\n# ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDKuMvHV/urlcaC6hnCy++9AKVJkNAKWc+sPZ1/QMTeeSRkj8uXiVoxtua3TKsdA3ETYiKLnN7/Krdz14XI5tb7yTgOHBmSPpo/lOYcEn+sD8E1fsNdOy11Hi9OsRWUaSOHf+1ROG5gtgIN0rXiFbuCpxNYdiCCsClNpvBrn0A11hfp7za08mLB9C/xUl1a0oyLFyDd95S50rMI28hyeWFtNBhcIPItNf/fBDfKqIwetgl5xrVASxRIOkWaiMximeRK7SUtcRnFhcaVuqLR/QWxviMirXF0w9rz4ULX2UYXF7eGxnm4xokaHoNwEULOP6megiHXuqmRewzVoslnn4QntNJfijPcyv2n3wqL4nXg6ZYVKiPx73GC/2YRA7mC0oVPJKavPANshCPkafoVzCFz95wVEQ8AvehiixWo3FqZ3ehsXeooPJ07lHb5XW09xBEzBxs/UB33N9ETxPpeg1JpkKUlVN1j1U7+UqWp8q6fJJECB8rhqN/zkg2W8cIaX6M= your_email@example.com\n\n// N\u1ed9i dung private key\n$ cat ~/.ssh/id_ecdsa\n"})}),"\n",(0,i.jsx)(e.p,{children:"3.1. V\u1edbi github"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"// Th\xeam publickey: V\xe0o trang ch\u1ee7 -> Settings/SSH --\x3e New SSH Key --\x3e \u0111i\u1ec1n Public key v\xe0o --\x3e l\xe0 xong\n// Ki\u1ec3m tra \u0111\xe3 k\u1ebft n\u1ed1i \u0111\u01b0\u1ee3c t\u1edbi github ch\u01b0a\nssh -T git@github.com\n// k\u1ebft qu\u1ea3\nThe authenticity of host gitlab.com (207.97.227.239) can't be established.\n# RSA key fingerprint is 16:27:ac:a5:76:28:2d:36:63:1b:56:4d:eb:df:a6:48.\n# Are you sure you want to continue connecting (yes/no)?\n\n// G\xf5 \"yes\"\n# Hi duyk30b! You've successfully authenticated, but GitHub does not provide shell access.\n// L\u01b0u \xfd v\u1edbi github: v\u1edbi key \u0111\xe3 b\u1ecb x\xf3a th\xec kh\xf4ng \u0111\u01b0\u1ee3c ph\xe9p d\xf9ng l\u1ea1i, bu\u1ed9c ph\u1ea3i t\u1ea1i c\u1eb7p key m\u1edbi\n"})}),"\n",(0,i.jsx)(e.p,{children:"3.2. V\u1edbi server kh\xe1c"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"// T\u1ea1i Server: th\xeam public key\n// T\u1ea1i Client k\u1ebft n\u1ed1i th\u1eed\nssh -i /home/duy.ngo/.ssh/id_ecdsa schatadmin@13.76.181.183\n"})}),"\n",(0,i.jsx)(e.h3,{id:"4-x\xf3a-key-c\u0169-\u0111\xe3-k\u1ebft-n\u1ed1i-do-server-c\u1eadp-nh\u1eadt-ho\u1eb7c-thay-\u0111\u1ed5i",children:"4. X\xf3a key c\u0169 \u0111\xe3 k\u1ebft n\u1ed1i do server c\u1eadp nh\u1eadt ho\u1eb7c thay \u0111\u1ed5i"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'ssh-keygen -f "/home/duy/.ssh/known_hosts" -R "123.172.129.229"\n\n'})}),"\n",(0,i.jsx)(e.h3,{id:"5-m\u1ed9t-v\xe0i-l\u01b0u-\xfd",children:"5. M\u1ed9t v\xe0i l\u01b0u \xfd"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"X\xf3a c\u1eb7p key"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"// Ki\u1ec3m tra c\xe1c public key \u0111ang t\u1ed3n t\u1ea1i trong ssh-add\n$ ssh-add -L\n// Ki\u1ec3m tra c\xe1c finger \u0111ang t\u1ed3n t\u1ea1i trong ssh-add\n$ ssh-add -l\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"B1: X\xf3a th\u1ee7 c\xf4ng trong folder /.ssh"}),"\n",(0,i.jsx)(e.li,{children:"B2: X\xf3a trong ssh-add"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"ssh-add -D\n"})}),"\n",(0,i.jsxs)(e.ol,{start:"2",children:["\n",(0,i.jsx)(e.li,{children:"N\u1ebfu c\xf3 c\u1ea3 c\u1eb7p public-key v\xe0 private-key --\x3e \u0111\u1ec3 trong th\u01b0 m\u1ee5c g\u1ed1c /.ssh --\x3e khi ssh s\u1ebd t\u1ef1 \u0111\u1ed9ng t\xecm key k\u1ebft n\u1ed1i \u0111\u01b0\u1ee3c --\x3e \u1ea3o ch\u01b0a"}),"\n",(0,i.jsx)(e.li,{children:'N\u1ebfu ch\u1ec9 c\xf3 m\u1ed7i private-key --\x3e \u0111\u01b0\u01a1ng nhi\xean c\u1ea7n ph\u1ea3i c\xf3 tham s\u1ed1 "-i" trong l\u1ec7nh ssh'}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"ii-config-server",children:"II. Config Server"}),"\n",(0,i.jsx)(e.h3,{id:"1-th\xeam-public-key",children:"1. Th\xeam public-key"}),"\n",(0,i.jsx)(e.h4,{id:"11-th\xeam-public-key",children:"1.1. Th\xeam public key"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"$ nano ~/.ssh/authorized_keys // Ch\u1ec9 c\u1ea7n th\xeam public key v\xe0o file n\xe0y l\xe0 \u0111\u01b0\u1ee3c\n"})}),"\n",(0,i.jsx)(e.h4,{id:"12-c\u1ea5u-h\xecnh-sshd",children:"1.2. C\u1ea5u h\xecnh sshd"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["V\u1edbi Ubnuntu: ",(0,i.jsx)(e.code,{children:"sudo vi /etc/ssh/sshd_config"})]}),"\n",(0,i.jsxs)(e.li,{children:["V\u1edbi Windows ",(0,i.jsx)(e.code,{children:"C:\\ProgramData\\sshd_config"})]}),"\n",(0,i.jsx)(e.li,{children:"B\u1eadt x\xe1c th\u1ef1c b\u1eb1ng Key l\xean"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"PubkeyAuthentication yes\nAuthorizedKeysFile .ssh/authorized_keys\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"M\u1ed9t s\u1ed1 setting kh\xe1c"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"Port 22\nListenAddress 0.0.0.0 // cho ph\xe9p k\u1ebft n\u1ed1i: v\u1edbi m\u1ecdi IP\nPasswordAuthentication yes // nh\u1eadp Password \u0111\u1ec3 k\u1ebft n\u1ed1i SSH: cho ph\xe9p, n\u1ebfu kh\xf4ng cho ph\xe9p th\xec ch\u1ec9 c\xf2n ph\u01b0\u01a1ng ph\xe1p k\u1ebft n\u1ed1i b\u1eb1ng c\u1eb7p key\nPermitEmptyPasswords no // Cho ph\xe9p password r\u1ed7ng: kh\xf4ng\nMaxAuthTries 6 // S\u1ed1 l\u1ea7n nh\u1eadp m\u1eadt kh\u1ea9u: 6\nPermitRootLogin no // Cho ph\xe9p T\xe0i kho\u1ea3n Root login: kh\xf4ng, C\xe1c t\xf9y ch\u1ecdn: prohibit-password (ph\u1ea3i d\xf9ng key SSH); no; yes\nClientAliveInterval 300 // Th\u1eddi gian ch\u1edd nh\xe0n r\u1ed7i: 300 gi\xe2y, sau \u0111\xf3 disconnect\nPubkeyAuthentication yes // Cho ph\xe9p x\xe1c th\u1ef1c b\u1eb1ng c\u1eb7p key\nAuthorizedKeysFile .ssh/authorized_keys .ssh/authorized_keys2 // V\u1ecb tr\xed \u0111\u1eb7t file key, v\u1edbi t\xe0i kho\u1ea3n duycode th\xec th\u01b0 m\u1ee5c l\xe0: duycode/.ssh/authorized_keys\n"})}),"\n",(0,i.jsxs)(e.ol,{start:"3",children:["\n",(0,i.jsx)(e.li,{children:"Kh\u1edfi \u0111\u1ed9ng l\u1ea1i SSH daemon"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"sudo systemctl restart sshd\n"})}),"\n",(0,i.jsxs)(e.ol,{start:"4",children:["\n",(0,i.jsx)(e.li,{children:"Th\u1eed tr\xean 1 m\xe1y t\xednh kh\xe1c k\u1ebft n\u1ed1i b\u1eb1ng SSH xem k\u1ebft n\u1ed1i \u0111\u01b0\u1ee3c ch\u01b0a"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"ssh root@34.87.178.129 // port m\u1eb7c \u0111\u1ecbnh 22\nssh root@34.87.178.129 -p 2233 // n\u1ebfu \u0111\u1ed5i c\u1ed5ng port sang 2233\n"})}),"\n",(0,i.jsxs)(e.ol,{start:"5",children:["\n",(0,i.jsx)(e.li,{children:"L\u01b0u \xfd"}),"\n"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"M\u1ed7i l\u1ea7n SSH v\xe0o 1 server, client s\u1ebd l\u01b0u l\u1ea1i server \u0111\xf3 (g\u1ecdi l\xe0 fingerprint)"}),"\n",(0,i.jsx)(e.li,{children:"Gi\u1ea3 s\u1eed server \u0111\xf3 c\xe0i l\u1ea1i h\u1ec7 \u0111i\u1ec1u h\xe0nh, v\u1eabn d\xf9ng user v\xe0 password c\u0169 th\xec client k\u1ebft n\u1ed1i v\xe0o s\u1ebd l\u1ed7i"}),"\n",(0,i.jsx)(e.li,{children:"L\xfac n\xe0y c\u1ea7n x\xf3a th\xf4ng tin trong fingerprint m\u1edbi k\u1ebft n\u1ed1i l\u1ea1i \u0111\u01b0\u1ee3c"}),"\n",(0,i.jsx)(e.li,{children:"Th\xf4ng tin c\xe1c fingerprint \u0111\u01b0\u1ee3c l\u01b0u \u1edf: known_hosts"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"cat  ~/.ssh/known_hosts\n"})}),"\n",(0,i.jsx)(e.h2,{id:"iii-connect-\u0111\u01a1n-gi\u1ea3n",children:"III. Connect \u0111\u01a1n gi\u1ea3n"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"$ cd ~/.ssh\n// -i: \u0111i\u1ec1n path l\u01b0u key\n$ sudo ssh -i version_schat schatadmin@13.76.181.183\n"})}),"\n",(0,i.jsx)(e.p,{children:"2.2. Config Client\n\u0110\u1ec3 connect \u0111\u01a1n gi\u1ea3n cho nh\u1eefng l\u1ea7n sau, c\xf3 th\u1ec3 d\xf9ng file config schat"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"T\u1ea1o file config"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"// Show c\xe1c file hi\u1ec7n c\xf3 trong .ssh\n$ ls ~/.ssh\n# id_rsa\n# id_rsa.pub\n# known_hosts\n# version_schat\n# version_schat.pub\n\n// N\u1ebfu ch\u01b0a c\xf3 file config th\xec c\u1ea7n ph\u1ea3i t\u1ea1o\n$ touch ~/.ssh/config\n\n// File n\xe0y ch\u1ec9 c\xf3 th\u1ec3 \u0111\u1ecdc \u0111\u01b0\u1ee3c v\xe0 c\xf3 th\u1ec3 ghi b\u1edfi ng\u01b0\u1eddi d\xf9ng v\xe0 kh\xf4ng th\u1ec3 truy c\u1eadp \u0111\u01b0\u1ee3c b\u1edfi ng\u01b0\u1eddi kh\xe1c:\nchmod 600 ~/.ssh/config\n\n// Show l\u1ea1i ki\u1ec3m tra xem \u0111\xe3 c\xf3 file config ch\u01b0a\n$ ls ~/.ssh\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"S\u1eeda file config"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'Host schat\n\tHostName 13.76.181.183\n\tUser schatadmin\n\tPort 22\n\tPreferredAuthentications publickey\n\tIdentityFile "/home/duy.ngo/.ssh/version_schat"\n\n'})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Th\u1eed k\u1ebft n\u1ed1i"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"// Tr\u01b0\u1edbc \u0111\xe2y, khi connect th\xec c\u1ea7n nh\u01b0 sau\n$ cd ~/.ssh\n$ sudo ssh -i version_schat schatadmin@13.76.181.183\n\n// Sau khi config\n$ ssh schat\n"})})]})}function a(n={}){const{wrapper:e}={...(0,h.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(l,{...n})}):l(n)}},8453:(n,e,s)=>{s.d(e,{R:()=>t,x:()=>r});var i=s(6540);const h={},c=i.createContext(h);function t(n){const e=i.useContext(c);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function r(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(h):n.components||h:t(n.components),i.createElement(c.Provider,{value:e},n.children)}}}]);