"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[1132],{7328:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>c,contentTitle:()=>E,default:()=>u,frontMatter:()=>a,metadata:()=>l,toc:()=>i});var o=t(4848),r=t(8453);const a={},E="SQL SERVER",l={id:"database/sql/sql-server",title:"SQL SERVER",description:"Ng\xf4n ng\u1eef truy v\u1ea5n SQL c\xf3 c\xe1c th\xe0nh ph\u1ea7n ch\xednh:",source:"@site/content/database/sql/sql-server.md",sourceDirName:"database/sql",slug:"/database/sql/sql-server",permalink:"/blog/content/database/sql/sql-server",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/content/database/sql/sql-server.md",tags:[],version:"current",frontMatter:{},sidebar:"sqlSidebar",previous:{title:"SQL Injection",permalink:"/blog/content/database/sql/sql-injection"},next:{title:"Transaction",permalink:"/blog/content/database/sql/transaction"}},c={},i=[{value:"1. T\u1ea1o b\u1ea3ng: CREATE TABLE",id:"1-t\u1ea1o-b\u1ea3ng-create-table",level:2},{value:"2. Th\xeam d\u1eef li\u1ec7u cho b\u1ea3ng: INSERT TO",id:"2-th\xeam-d\u1eef-li\u1ec7u-cho-b\u1ea3ng-insert-to",level:2},{value:"3. Thao t\xe1c \u0111\u1ecbnh ngh\u0129a d\u1eef li\u1ec7u - DDL Command",id:"3-thao-t\xe1c-\u0111\u1ecbnh-ngh\u0129a-d\u1eef-li\u1ec7u---ddl-command",level:2},{value:"4. Thao t\xe1c d\u1eef li\u1ec7u - DML Command",id:"4-thao-t\xe1c-d\u1eef-li\u1ec7u---dml-command",level:2},{value:"5. C\xe2u l\u1ec7nh truy v\u1ea5n: SELECT",id:"5-c\xe2u-l\u1ec7nh-truy-v\u1ea5n-select",level:2},{value:"6. Khung nh\xecn: VIEW",id:"6-khung-nh\xecn-view",level:2},{value:"7. T\u1ea1o ch\u1ec9 m\u1ee5c: INDEX",id:"7-t\u1ea1o-ch\u1ec9-m\u1ee5c-index",level:2},{value:"8. T\u1ea1o c\xe1c th\u1ee7 t\u1ee5c l\u01b0u tr\u1eef: PROCEDURE",id:"8-t\u1ea1o-c\xe1c-th\u1ee7-t\u1ee5c-l\u01b0u-tr\u1eef-procedure",level:2},{value:"9. T\u1ea1o Trigger",id:"9-t\u1ea1o-trigger",level:2}];function h(n){const e={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.header,{children:(0,o.jsx)(e.h1,{id:"sql-server",children:"SQL SERVER"})}),"\n",(0,o.jsx)(e.p,{children:"Ng\xf4n ng\u1eef truy v\u1ea5n SQL c\xf3 c\xe1c th\xe0nh ph\u1ea7n ch\xednh:"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"Ng\xf4n ng\u1eef Thao t\xe1c D\u1eef li\u1ec7u - Data Manipulation Language (DML)"}),"\n",(0,o.jsx)(e.li,{children:"Ng\xf4n ng\u1eef \u0110\u1ecbnh ngh\u0129a D\u1eef li\u1ec7u - Data Definition Language (DDL)"}),"\n",(0,o.jsx)(e.li,{children:"Ng\xf4n ng\u1eef Ki\u1ec3m so\xe1t D\u1eef li\u1ec7u - Data Control Language (DCL)"}),"\n",(0,o.jsx)(e.li,{children:"Data Query Language (DQL)"}),"\n"]}),"\n",(0,o.jsx)("img",{src:"https://img1.daumcdn.net/thumb/R800x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F99923F3B5B05D4712E",alt:""}),"\n",(0,o.jsx)(e.p,{children:"C\xf4ng ty CitySoftware c\u1ea7n l\u1eadp 1 Databse bao g\u1ed3m 4 b\u1ea3ng \u0111\u1ec3 qu\u1ea3n l\xfd d\u1eef li\u1ec7u bao g\u1ed3m: Employee, GroupWork, GroupDetail, Project.\nTrong \u0111\xf3: 1 Employee c\xf3 th\u1ec3 tham gia nhi\u1ec1u GroupWork, 1 GroupWork c\xf3 nhi\u1ec1u Employee v\xe0 1 Project bao g\u1ed3m nhi\u1ec1u GroupWork"}),"\n",(0,o.jsx)("img",{src:"https://drive.google.com/thumbnail?id=1dI_RDc6qvyMSAxtdx0tQLSckzNY9D0c4&sz=w800"}),"\n",(0,o.jsx)(e.h2,{id:"1-t\u1ea1o-b\u1ea3ng-create-table",children:"1. T\u1ea1o b\u1ea3ng: CREATE TABLE"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-sql",children:"CREATE TABLE Project(\n\tProjectID int IDENTITY(1,1) PRIMARY KEY,\n\tProjectName Nvarchar(30),\n\tStartDate date,\n\tEndDate date,\n\tPeriod int,\n\tCost money\n);\n\nCREATE TABLE GroupWork(\n\tGroupID int IDENTITY(1,1) PRIMARY KEY,\n\tGroupName varchar(30),\n\tLeaderID int,\n\tProjectID int NOT NULL FOREIGN KEY REFERENCES Project(ProjectID)\n);\n\nCREATE TABLE Employee(\n\tEmployeeID int IDENTITY(1,1) PRIMARY KEY,\n\tName varchar(100),\n\tTel char(10) UNIQUE,\n\tEmail varchar(30),\n\tBirthday date,\n\tCONSTRAINT check_birthday CHECK (Birthday < GETDATE())\n);\n\nCREATE TABLE GroupDetail(\n\tGroupID int NOT NULL FOREIGN KEY REFERENCES GroupWork(GroupID),\n\tEmployeeID int NOT NULL FOREIGN KEY REFERENCES Employee(EmployeeID),\n\tStatusemployee Nvarchar(100)\n);\n"})}),"\n",(0,o.jsx)(e.h2,{id:"2-th\xeam-d\u1eef-li\u1ec7u-cho-b\u1ea3ng-insert-to",children:"2. Th\xeam d\u1eef li\u1ec7u cho b\u1ea3ng: INSERT TO"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-sql",children:"INSERT INTO Project(ProjectName,StartDate,EndDate,Period,Cost)\n\tVALUES (N'X\xe2y c\u1ea7u v\u01b0\u1ee3t','2020-01-02','2020-12-15',12,1000);\nINSERT INTO Project(ProjectName,StartDate,EndDate,Period,Cost)\n\tVALUES (N'X\xe2y chung c\u01b0','2015-05-10','2018-09-20',20,800);\nINSERT INTO Project\n\tVALUES (N'Ch\xednh ph\u1ee7 \u0111i\u1ec7n t\u1eed','2018-02-15','2022-09-15',7,150150);\n\nINSERT INTO GroupWork(GroupName,LeaderID,ProjectID)\n\tVALUES ('Nhom ONE',1,1);\nINSERT INTO GroupWork\n\tVALUES ('Nhom VIPPRO',3,2);\nINSERT INTO GroupWork\n\tVALUES ('Nhom Nhanuoc',4,3);\n\nINSERT INTO Employee(Name,Tel,Email)\n\tVALUES ('Nguyen van A','0123456789','nguyenvana@gmail.com');\nINSERT INTO Employee(Name,Tel,Email)\n\tVALUES ('Tran thi B','0987111222','tranthib@gmail.com');\nINSERT INTO Employee(Name,Tel,Email)\n\tVALUES ('Do Hong C','0123412345','dohongc@gmail.com');\nINSERT INTO Employee(Name,Tel,Email)\n\tVALUES ('Ngo Van D','0986021190','duyhn90a@gmail.com');\nINSERT INTO Employee(Name,Tel,Email)\n\tVALUES ('Bui Thi Tr','0968100994','buitrang@gmail.com');\n\nINSERT INTO GroupDetail(GroupID,EmployeeID,Statusemployee)\n\tVALUES (1,1,N'\u0111\xe3 l\xe0m');\nINSERT INTO GroupDetail\n\tVALUES (1,3,N'\u0111ang l\xe0m');\nINSERT INTO GroupDetail\n\tVALUES (2,2,N's\u1eafp l\xe0m');\nINSERT INTO GroupDetail\n\tVALUES (2,4,N'\u0111ang l\xe0m');\nINSERT INTO GroupDetail\n\tVALUES (2,3,N'\u0111ang l\xe0m');\nINSERT INTO GroupDetail\n\tVALUES (3,4,N'\u0111ang l\xe0m');\nINSERT INTO GroupDetail\n\tVALUES (3,5,N's\u1eafp l\xe0m');\n"})}),"\n",(0,o.jsx)(e.h2,{id:"3-thao-t\xe1c-\u0111\u1ecbnh-ngh\u0129a-d\u1eef-li\u1ec7u---ddl-command",children:"3. Thao t\xe1c \u0111\u1ecbnh ngh\u0129a d\u1eef li\u1ec7u - DDL Command"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-sql",children:"-- 3.a. S\u1eeda c\u1ed9t, th\xeam c\u1ed9t, x\xf3a c\u1ed9t ( ph\u1ea3i x\xf3a constraint tr\u01b0\u1edbc)\nALTER TABLE EMployee ALTER COLUMN Name Nvarchar(50);\nALTER TABLE Employee ADD IdentityCard int NOT NULL DEFAULT(10000);\nALTER TABLE Employee DROP CONSTRAINT check_birthday;\nALTER TABLE Employee DROP COLUMN Birthday;\n\n-- 3.b. Ng\xe0y ho\xe0n th\xe0nh d\u1ef1 \xe1n ph\u1ea3i sau ng\xe0y b\u1eaft \u0111\u1ea7u d\u1ef1 \xe1n\nALTER TABLE Project ADD CHECK (EndDate > StartDate);\n\n-- 3.c. Tr\u01b0\u1eddng tr\u1ea1ng th\xe1i l\xe0m vi\u1ec7c ch\u1ec9 nh\u1eadn 1 trong 3 tr\u1ea1ng th\xe1i: inprogress, pending, done\nALTER TABLE GroupDetail ADD CHECK (GroupDetail.Statusemployee IN (N'\u0111\xe3 l\xe0m',N'\u0111ang l\xe0m',N's\u1eafp l\xe0m'));\n\n-- 3.d. \u0110i\u1ec7n tho\u1ea1i ch\u1ec9 \u0111\u01b0\u1ee3c nh\u1eadp s\u1ed1 v\xe0 b\u1eaft \u0111\u1ea7u b\u1eb1ng s\u1ed1 0, Email c\xf3 \u0111\u1ecbnh d\u1ea1ng @.\nALTER TABLE Employee ADD CONSTRAINT check_tel CHECK (Tel LIKE '0%' AND Tel NOT LIKE '%[^0-9]%');\nALTER TABLE Employee ADD CHECK(Email LIKE '%_@_%._%');\n\n-- 3.e. Tr\u01b0\u1edfng nh\xf3m (LeaderID) ph\u1ea3i l\xe0 nh\xe2n vi\xean (EmployeeID)\nIF OBJECT_ID('dbo.Check_LeaderID') IS NOT NULL\n\tDROP FUNCTION Check_LeaderID; \nGO\nCREATE FUNCTION Check_LeaderID (@ckLeaderID int)\nRETURNS int AS\nBEGIN\n\tIF EXISTS (SELECT EmployeeID From Employee WHERE EmployeeID = @ckLeaderID)\n        RETURN 1\n\tRETURN 0\nEND;\nGO\nALTER TABLE GroupWork ADD CONSTRAINT check_constraint_LeaderID CHECK (dbo.Check_LeaderID(LeaderID) = 1);\n"})}),"\n",(0,o.jsx)(e.h2,{id:"4-thao-t\xe1c-d\u1eef-li\u1ec7u---dml-command",children:"4. Thao t\xe1c d\u1eef li\u1ec7u - DML Command"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-sql",children:"-- 4.a. X\xf3a b\u1ea3ng GroupDetail v\xe0 x\xf3a Employee 'Ngo Van D'\nDELETE FROM GroupDetail;\nDELETE FROM Employee WHERE Name LIKE 'Ngo Van D';\n-- 4.b. Update EmployeeID = 5 v\u1edbi Name = 'Bui Thi Trang', Email = 'drtrang@gmail.com'\nUPDATE Employee\nSET Name = 'Bui Thi Trang', Email = 'drtrang@gmail.com'\nWHERE EmployeeID = 5;\n"})}),"\n",(0,o.jsx)(e.h2,{id:"5-c\xe2u-l\u1ec7nh-truy-v\u1ea5n-select",children:"5. C\xe2u l\u1ec7nh truy v\u1ea5n: SELECT"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-sql",children:"-- 5.a. Xem danh s\xe1ch t\u1ea5t c\u1ea3 nh\xe2n vi\xean\nSELECT * FROM Employee\n\tORDER BY EmployeeID ASC;\n-- 5.b. Li\u1ec7t k\xea danh s\xe1ch nh\xe2n vi\xean \u0111ang l\xe0m d\u1ef1 \xe1n \"ch\xednh ph\u1ee7 \u0111i\u1ec7n t\u1eed\"\nSELECT Employee.*,Project.ProjectName FROM Employee\n\tLEFT JOIN GroupDetail ON Employee.EmployeeID = GroupDetail.EmployeeID \n\tLEFT JOIN GroupWork ON GroupDetail.GroupID = GroupWork.GroupID\n\tLEFT JOIN Project ON GroupWork.ProjectID = Project.ProjectID\n\tWHERE (ProjectName LIKE N'Ch\xednh ph\u1ee7 \u0111i\u1ec7n t\u1eed');\n\n-- 5.c. Th\u1ed1ng k\xea s\u1ed1 nh\xe2n vi\xean \"\u0111ang l\xe0m vi\u1ec7c\" t\u1ea1i m\u1ed7i nh\xf3m\nSELECT GroupWork.GroupName, COUNT(GroupDetail.EmployeeID) FROM GroupWork\n\tLEFT JOIN GroupDetail ON GroupWork.GroupID = GroupDetail.GroupID\n\tWHERE Statusemployee LIKE N'\u0111ang l\xe0m'\n\tGROUP BY GroupName;\n"})}),"\n",(0,o.jsx)(e.h2,{id:"6-khung-nh\xecn-view",children:"6. Khung nh\xecn: VIEW"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-sql",children:"-- 6.a. T\u1ea1o khung nh\xecn all_information: Li\u1ec7t k\xea th\xf4ng tin v\u1ec1 nh\xe2n vi\xean, nh\xf3m l\xe0m vi\u1ec7c c\xf3 d\u1ef1 \xe1n \u0111ang th\u1ef1c hi\u1ec7n\nCREATE VIEW all_information\nAS\nSELECT GroupWork.GroupName,Employee.Name,Project.ProjectName,Project.StartDate,Project.EndDate FROM Employee\n\tFULL JOIN GroupDetail ON Employee.EmployeeID = GroupDetail.EmployeeID\n\tFULL JOIN GroupWork ON GroupDetail.GroupID = GroupWork.GroupID\n\tFULL JOIN Project ON GroupWork.ProjectID = Project.ProjectID\n\tWHERE Project.StartDate < GETDATE() AND Project.EndDate > GETDATE();\nGO\nSELECT * FROM all_information;\n\n-- 6.b. S\u1eeda khung nh\xecn all_information \nALTER VIEW all_information\nAS\nSELECT Employee.Name,GroupWork.GroupName,Project.ProjectName,Project.StartDate,Project.EndDate FROM Employee\n\tFULL JOIN GroupDetail ON Employee.EmployeeID = GroupDetail.EmployeeID\n\tFULL JOIN GroupWork ON GroupDetail.GroupID = GroupWork.GroupID\n\tFULL JOIN Project ON GroupWork.ProjectID = Project.ProjectID\n\tWHERE Project.StartDate < GETDATE() AND Project.EndDate > GETDATE();\nGO\nSELECT * FROM all_information;\n\n-- 6.c. X\xf3a khung nh\xecn all_information\nDROP VIEW dbo.all_information;\nGO\n"})}),"\n",(0,o.jsx)(e.h2,{id:"7-t\u1ea1o-ch\u1ec9-m\u1ee5c-index",children:"7. T\u1ea1o ch\u1ec9 m\u1ee5c: INDEX"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-sql",children:"-- a. T\u1ea1o ch\u1ec9 m\u1ee5c duy nh\u1ea5t t\xean l\xe0 IX_Group tr\xean 2 tr\u01b0\u1eddng GroupID v\xe0 EmployeeID c\u1ee7a b\u1ea3ng GroupDetail\nDROP INDEX GroupDetail.IX_Group\nCREATE UNIQUE INDEX IX_Group ON GroupDetail(GroupID,EmployeeID);\n\n-- b. T\u1ea1o ch\u1ec9 m\u1ee5c t\xean l\xe0 IX_Project tr\xean tr\u01b0\u1eddng ProjectName c\u1ee7a b\u1ea3ng Project g\u1ed3m c\xe1c tr\u01b0\u1eddng StartDate v\xe0 EndDate\nDROP INDEX Project.IX_Project\nCREATE INDEX IX_Project ON Project(StartDate,EndDate);\n"})}),"\n",(0,o.jsx)(e.h2,{id:"8-t\u1ea1o-c\xe1c-th\u1ee7-t\u1ee5c-l\u01b0u-tr\u1eef-procedure",children:"8. T\u1ea1o c\xe1c th\u1ee7 t\u1ee5c l\u01b0u tr\u1eef: PROCEDURE"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-sql",children:"-- a. T\u0103ng gi\xe1 th\xeam 10% c\xe1c d\u1ef1 \xe1n c\xf3 gi\xe1 tr\u1ecb nh\u1ecf h\u01a1n 2000\nDROP PROCEDURE Project_UpdateCost;\nCREATE PROCEDURE Project_UpdateCost \nAS BEGIN\nUPDATE Project\n\tSET Cost = (Cost*1.1)\n\tWHERE Cost < 2000;\nEND;\nEXEC Project_UpdateCost;\n\n-- b. Hi\u1ec3n th\u1ecb th\xf4ng tin v\u1ec1 d\u1ef1 \xe1n s\u1eafp \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n\nDROP PROCEDURE Project_near;\nCREATE PROCEDURE Project_near\nAS BEGIN\nSELECT * FROM Project WHERE StartDate > GETDATE()\nEND;\nEXEC Project_near;\n\n-- c. Hi\u1ec3n th\u1ecb th\xf4ng tin li\xean quan v\u1ec1 c\xe1c d\u1ef1 \xe1n \u0111\xe3 ho\xe0n th\xe0nh\nDROP PROCEDURE Project_done\nCREATE PROCEDURE Project_done\nAS\nSELECT * FROM Project\n\tLEFT JOIN GroupWork ON Project.ProjectID = GroupWork.ProjectID\n\tLEFT JOIN GroupDetail ON GroupWork.GroupID = GroupDetail.GroupID\n\tLEFT JOIN Employee ON GroupDetail.EmployeeID = Employee.EmployeeID\n\tWHERE EndDate < GETDATE()\nGO;\nEXEC Project_done;\n"})}),"\n",(0,o.jsx)(e.h2,{id:"9-t\u1ea1o-trigger",children:"9. T\u1ea1o Trigger"}),"\n",(0,o.jsx)(e.p,{children:"a. Khi tr\u01b0\u1eddng EndDate \u0111\u01b0\u1ee3c c\u1eadp nh\u1eadtth\xec t\u1ef1 \u0111\u1ed9ng t\xednh to\xe1n t\u1ed5ng th\u1eddi gian ho\xe0n th\xe0nh d\u1ef1 \xe1n v\xe0 c\u1eadp nh\u1eadt v\xe0o tr\u01b0\u1eddng Period\nb. \u0110\u1ea3m b\u1ea3o r\u1eb1ng khi x\xf3a m\u1ed9t Group th\xec t\u1ea5t c\u1ea3 nh\u1eefng b\u1ea3n ghi c\xf3 li\xean quan trong b\u1ea3ng GroupDetail c\u0169ng s\u1ebd b\u1ecb x\xf3a theo.\nc. Kh\xf4ng cho ph\xe9p ch\xe8n 2 nh\xf3m c\xf3 c\xf9ng t\xean v\xe0o trong b\u1ea3ng Group."})]})}function u(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(h,{...n})}):h(n)}},8453:(n,e,t)=>{t.d(e,{R:()=>E,x:()=>l});var o=t(6540);const r={},a=o.createContext(r);function E(n){const e=o.useContext(a);return o.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:E(n.components),o.createElement(a.Provider,{value:e},n.children)}}}]);